@{
    ViewData["Title"] = "Import / Export";
}

<div class="container mx-auto px-4 py-8">
    <div class="flex flex-col items-center justify-center mb-12 text-center">
        <h2 class="text-4xl font-extrabold text-gray-900 tracking-tight">Data Management</h2>
        <p class="text-gray-500 mt-3 max-w-xl">
            Manage your transit data. Import complete GTFS feeds via ZIP or export your current database to a standard GTFS package.
        </p>
    </div>

    @if (TempData["Success"] != null)
    {
        <div class="max-w-4xl mx-auto mb-8 bg-green-50 border-l-4 border-green-500 p-4 rounded-r shadow-sm">
            <div class="flex">
                <div class="flex-shrink-0">
                    <i class="fas fa-check-circle text-green-500"></i>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-green-700">@TempData["Success"]</p>
                </div>
            </div>
        </div>
    }

    @if (TempData["Error"] != null)
    {
        <div class="max-w-4xl mx-auto mb-8 bg-red-50 border-l-4 border-red-500 p-4 rounded-r shadow-sm">
            <div class="flex">
                <div class="flex-shrink-0">
                    <i class="fas fa-exclamation-circle text-red-500"></i>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-red-700">@TempData["Error"]</p>
                </div>
            </div>
        </div>
    }

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-6xl mx-auto">
        <!-- Import Card -->
        <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100 flex flex-col items-center text-center p-8 transition-transform hover:-translate-y-1 hover:shadow-2xl">
            <div class="w-16 h-16 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-2xl mb-6">
                <i class="fas fa-file-import"></i>
            </div>
            <h3 class="text-2xl font-bold text-gray-900 mb-2">Import GTFS Feed</h3>
            <p class="text-gray-500 mb-8 text-sm">
                Upload a standard .zip file containing your GTFS text files (agency.txt, stops.txt, etc).
                <br/><span class="text-xs text-orange-500"><i class="fas fa-exclamation-triangle"></i> Starts a fresh import process.</span>
            </p>

            <form asp-controller="Import" asp-action="UploadZip" method="post" enctype="multipart/form-data" class="w-full max-w-sm space-y-4">
                <div class="relative group">
                    <input type="file" name="file" accept=".zip" class="block w-full text-sm text-gray-500
                        file:mr-4 file:py-2.5 file:px-4
                        file:rounded-full file:border-0
                        file:text-sm file:font-semibold
                        file:bg-indigo-50 file:text-indigo-700
                        hover:file:bg-indigo-100 cursor-pointer" required />
                </div>
                
                <button type="submit" class="w-full py-3 px-6 rounded-lg bg-indigo-600 text-white font-bold text-sm uppercase tracking-wider hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all shadow-md">
                    <i class="fas fa-upload mr-2"></i> Upload & Process
                </button>
            </form>
        </div>

        <!-- Export Card -->
        <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100 flex flex-col items-center text-center p-8 transition-transform hover:-translate-y-1 hover:shadow-2xl">
            <div class="w-16 h-16 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center text-2xl mb-6">
                <i class="fas fa-file-export"></i>
            </div>
            <h3 class="text-2xl font-bold text-gray-900 mb-2">Export GTFS Feed</h3>
            <p class="text-gray-500 mb-8 text-sm">
                Package your current database into a valid GTFS .zip file. 
                <br/><span class="text-xs text-gray-400">Includes all updated routes, stops, and schedules.</span>
            </p>

            <div class="w-full max-w-sm flex flex-col gap-3">
                <a asp-controller="Import" asp-action="ExportZip" class="flex items-center justify-center w-full py-3 px-6 rounded-lg bg-emerald-600 text-white font-bold text-sm uppercase tracking-wider hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 transition-all shadow-md">
                    <i class="fas fa-download mr-2"></i> Download GTFS.zip
                </a>
                <a asp-controller="Import" asp-action="Audit" class="flex items-center justify-center w-full py-3 px-6 rounded-lg bg-blue-100 text-blue-700 font-bold text-sm uppercase tracking-wider hover:bg-blue-200 transition-all">
                    <i class="fas fa-microscope mr-2"></i> Run Compliance Audit
                </a>
            </div>
        </div>
    </div>

    <!-- Instructions / Footer -->
    <div class="mt-16 text-center">
        <p class="text-xs text-gray-400 uppercase tracking-widest font-semibold">Supported Files</p>
        <div class="flex flex-wrap justify-center gap-4 mt-4 mb-16 opacity-70">
            <span class="px-3 py-1 bg-gray-100 rounded text-xs text-gray-600">agency.txt</span>
            <span class="px-3 py-1 bg-gray-100 rounded text-xs text-gray-600">stops.txt</span>
            <span class="px-3 py-1 bg-gray-100 rounded text-xs text-gray-600">routes.txt</span>
            <span class="px-3 py-1 bg-gray-100 rounded text-xs text-gray-600">trips.txt</span>
            <span class="px-3 py-1 bg-gray-100 rounded text-xs text-gray-600">stop_times.txt</span>
            <span class="px-3 py-1 bg-gray-100 rounded text-xs text-gray-600">calendar.txt</span>
            <span class="px-3 py-1 bg-gray-100 rounded text-xs text-gray-600">shapes.txt</span>
        </div>
        
        <!-- Danger Zone -->
        <div class="max-w-xl mx-auto border-t border-gray-200 pt-8">
            <h4 class="text-xs font-bold text-red-500 uppercase tracking-widest mb-4">Danger Zone</h4>
            <div class="bg-red-50 rounded-xl p-6 border border-red-100 flex items-center justify-between">
                <div class="text-left">
                    <h5 class="font-bold text-red-800 text-sm">Clear Database</h5>
                    <p class="text-xs text-red-600 mt-1">Delete all imported data including routes, stops, and schedules.</p>
                </div>
                <form asp-action="ClearDatabase" method="post" onsubmit="return confirm('WARNING: This will obliterate ALL data in the database. Are you absolutely sure?');">
                    <button type="submit" class="px-4 py-2 bg-white border border-red-200 text-red-600 rounded-lg text-xs font-bold hover:bg-red-600 hover:text-white transition-all shadow-sm">
                        <i class="fas fa-trash-alt mr-1"></i> Wipe Data
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
